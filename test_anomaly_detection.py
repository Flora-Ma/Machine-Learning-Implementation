import numpy as np
import anomaly_detection

X_train = np.array([
    [13.04681517, 14.74115241],
    [13.40852019, 13.7632696 ],
    [14.19591481, 15.85318113],
    [14.91470077, 16.17425987],
    [13.57669961, 14.04284944],
    [13.92240251, 13.40646894],
    [12.82213164, 14.22318782],
    [15.67636615, 15.89169137],
    [16.16287532, 16.20299807],
    [12.66645095, 14.89908374],
    [13.98454962, 12.95800822],
    [14.06146043, 14.54908874],
    [13.38988671, 15.56202142],
    [13.39350475, 15.62698794],
    [13.97900926, 13.28061494],
    [14.16791259, 14.46583829],
    [13.96176145, 14.75182421],
    [14.45899735, 15.07018563],
    [14.58476372, 15.82743424],
    [12.07427074, 13.0671109 ]])
mu, var = anomaly_detection.estimate_gaussian(X_train)
print(f'mu = {mu}, var = {var}')
X_val = np.array([[15.79025979, 14.9210243 ],
 [13.63961877, 15.32995521],
 [14.86589943, 16.47386514],
 [13.58467605, 13.98930611],
 [14.85934119, 14.90066474]])
y_val = np.array([1, 0, 0, 0, 1])
p_val = anomaly_detection.multivariate_gaussian(X_val, mu, var)
epsilon, F1 = anomaly_detection.select_threshold(y_val, p_val)
print(f'p_val = {p_val}, epsilon = {epsilon}, F1 = {F1}')